<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Live Location Sharing (User1)</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 50px;
      }
      #locationStatus {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <h1>Live Location Tracking (User 1)</h1>
    <p id="locationStatus">Tracking your location...</p>

    <!-- Firebase App (the core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>

    <script>
      // Your Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBPRbh40i_qAXQ_EGcHnJDBPEHwRIeDYUk",
        authDomain: "fir-mimo-01.firebaseapp.com",
        databaseURL: "https://fir-mimo-01-default-rtdb.firebaseio.com",
        projectId: "fir-mimo-01",
        storageBucket: "fir-mimo-01.appspot.com",
        messagingSenderId: "206447693108",
        appId: "1:206447693108:web:589c2d0da95ce1d8b4e961",
        measurementId: "G-7WP3NQW2HJ",
      };

      // Initialize Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const database = firebase.database();

      let watchId;

      // Function to start tracking location
      function startTracking() {
        if (navigator.geolocation) {
          watchId = navigator.geolocation.watchPosition(
            showPosition,
            showError
          );
        } else {
          document.getElementById("locationStatus").innerText =
            "Geolocation is not supported by this browser.";
        }
      }

      // Send the user's position to Firebase
      function showPosition(position) {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;

        // Update location in Firebase
        firebase.database().ref("users/user1").set({
          latitude: lat,
          longitude: lon,
        });

        // Update the UI
        const message = `Live Location: <a href="https://www.google.com/maps?q=${lat},${lon}" target="_blank">Open Map</a>`;
        document.getElementById("locationStatus").innerHTML = message;
      }

      // Handle errors
      function showError(error) {
        switch (error.code) {
          case error.PERMISSION_DENIED:
            document.getElementById("locationStatus").innerText =
              "User denied the request for Geolocation.";
            break;
          case error.POSITION_UNAVAILABLE:
            document.getElementById("locationStatus").innerText =
              "Location information is unavailable.";
            break;
          case error.TIMEOUT:
            document.getElementById("locationStatus").innerText =
              "The request to get user location timed out.";
            break;
          case error.UNKNOWN_ERROR:
            document.getElementById("locationStatus").innerText =
              "An unknown error occurred.";
            break;
        }
      }

      // Start tracking when the page loads
      window.onload = startTracking;
    </script>
  </body>
</html>
